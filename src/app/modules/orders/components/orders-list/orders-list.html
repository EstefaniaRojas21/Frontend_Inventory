<!-- src/app/modules/orders/components/orders-list/orders-list.html -->
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Órdenes</h2>
    <button class="btn btn-primary" (click)="newOrder()">
      <i class="bi bi-plus-circle"></i> Nueva Orden
    </button>
  </div>

  <div class="mb-3">
    <input type="text" class="form-control" placeholder="Buscar..." [(ngModel)]="query" />
  </div>

  <div *ngIf="loading" class="text-center mt-4">
    <div class="spinner-border"></div>
    <p class="mt-2">Cargando órdenes...</p>
  </div>

  <table *ngIf="!loading && pageItems().length > 0" class="table table-striped table-hover">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Cliente</th>
        <th>Teléfono</th>
        <th>Fecha</th>
        <th>Items</th>
        <th>Estado</th>
        <th class="text-center">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let o of pageItems()">
        <td>{{ o.id }}</td>
        <td>{{ o.customer_name }}</td>
        <td>{{ o.customer_phone || '-' }}</td>
        <td>{{ o.order_date ? (o.order_date | date:'short') : '-' }}</td>
        <td>{{ o.items ?? 0 }}</td>
        <td>{{ o.status }}</td>
        <td class="text-center">
          <button class="btn btn-sm btn-warning me-2" (click)="edit(o.id)">
            <i class="bi bi-pencil"></i>
          </button>
          <button class="btn btn-sm btn-danger" (click)="confirmDelete(o.id)">
            <i class="bi bi-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && pageItems().length === 0" class="alert alert-info">
    No hay órdenes registradas.
  </div>

  <!-- Confirm modal simple -->
  <div *ngIf="showConfirm" class="modal-backdrop" style="position:fixed; inset:0; display:flex; align-items:center; justify-content:center;">
    <div class="card p-3" style="width:320px;">
      <p>¿Eliminar orden #{{toDeleteId}}?</p>
      <div class="d-flex justify-content-end">
        <button class="btn btn-danger me-2" (click)="doDelete()" [disabled]="deleting">Eliminar</button>
        <button class="btn btn-secondary" (click)="cancelConfirm()">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Paginación simple -->
  <nav *ngIf="totalPages > 1" class="mt-3">
    <ul class="pagination">
      <li class="page-item" [class.disabled]="page===1"><a class="page-link" (click)="prevPage()">«</a></li>
      <li class="page-item" *ngFor="let p of [].constructor(totalPages); let i = index" [class.active]="page===i+1">
        <a class="page-link" (click)="goToPage(i+1)">{{ i+1 }}</a>
      </li>
      <li class="page-item" [class.disabled]="page===totalPages"><a class="page-link" (click)="nextPage()">»</a></li>
    </ul>
  </nav>
</div>
